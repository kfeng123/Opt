install.packages("ggplot2")
update.packages()
vignette(topic=lme4)
vignette(topic="lme4")
vignette(topic="lme")
vignette(package="lme4")
vignette(topic="lmer")
install.pakcages("brnn")
install.packages("brnn")
vignette("lme4")
vignette("lmer")
`(` <- function(e1) {
if (is.numeric(e1) && runif(1) < 0.1) {
e1 + 1
} else {
e1
}
}
replicate(50, (1 + 2))
rm("(")
replicate(50, (1 + 2))
c <- 10
c(c = c)
sapply
add <- function(x) {
function(y) x + y
}
adders <- lapply(1:10, add)
adders[[1]](10)
adders[[10]](10)
adders[[10]](10)
adders[[1]](10)
adders[[1]](10)
adders[[10]](10)
adders[[1]](10)
?%%
?`%%`
?`"`
`second<-` <- function(x, value) {
x[2] <- value
x
}
x <- 1:10
second(x) <- 5L
x
second(x)
?pryr
??pryr
library(pryr)
install.packages("pryr")
install.packages(help="pryr")
library(help="pryr")
!0
!1
!NULL
!numeric()
!(numeric())
!(NULL)
(a <- (b <- (c <- (d <- 2))))
a <- b <- c <- d <- 2
setwd("~")
a=setwd("~")
a
in_dir <- function(dir, code) {
old <- setwd(dir)
on.exit(setwd(old))
force(code)
}
in_dir(getwd())
in_dir(getwd(),getwd())
in_dir(getwd())
in_dir <- function(dir, code) {
old <- setwd(dir)
on.exit(setwd(old))
}
in_dir(getwd())
in_dir <- function(dir, code) {
old <- setwd(dir)
on.exit(setwd(old))
}
in_dir(getwd())
?on.exit
a=0
myF=function(x){
x
on.exit(a=a+1)
}
myF(1)
a=0
myF=function(x){
x
on.exit(a+1)
}
myF(1)
a=0
myF=function(x){
x
on.exit(a)
}
myF(1)
a=0
myF=function(x){
x
on.exit(print(a))
}
myF(1)
a=0
myF=function(x){
x
a=2
on.exit(print(a))
}
myF(1)
a
a=0
myF=function(x,a=1){
x
on.exit(print(a))
}
myF(1)
a=0
myF=function(x,a=1){
x
a=2
on.exit(print(a))
}
myF(1)
a
a=0
myF=function(x,a=1){
x
on.exit(print(a))
a=2
}
myF(1)
a=0
myF=function(x,a=1){
x
on.exit(print(a))
a=100
}
myF(1)
?UseMethod
UseMethod
library(readr)
?read_csv
f <- function(x) UseMethod("f")
f.a <- function(x) "Class a"
f(structure(list(), class = "a"))
f(structure(list(), class = "c"))
summary
all
any()
any
library(help="methods")
library(lme4)
data(sleep)
head(sleep)
lmer(extra~(1|group),data=sleep)
a=lmer(extra~(1|group),data=sleep)
str(a)
?mle
library(stats4)
?mle
library(help=stats4)
?mle
y <- c(26, 17, 13, 12, 20, 5, 9, 8, 5, 4, 8)
nLL <- function(lambda) - sum(dpois(y, lambda, log = TRUE))
fit <- mle(nLL, start = list(lambda = 5), nobs = length(y))
fit
?isS4
?nobs
nobs
getGenerics()
getGeneric()
getGenerics()
getClasses()
class?mle
?setClass
selectMethod("nobs", list("mle"))
method_from_call(nobs(fit))
library(pryr)
method_from_call(nobs(fit))
?nobs
?nobs.merMod
?setRefClass
library(lme4)
vignette("lme4")
vignette("lmer")
library(ggplot2)
library(readr)
library(dplyr)
library(lme4)
training = read_csv("./myData/mytraining.csv")
testing = read_csv("./myData/mytesting.csv")
myDateFeature=data.frame(day=1:31,
weekday=((1:31%%7)%in%c(2,3))+0
)
tempTimeSlice = data_frame(timeSlice = seq(from = 46, to = 142, by = 12), h = 1)
tempDate = data_frame(day = seq(from = 22, to = 30, by = 2), h = 1)
tempDistrict = data_frame(district_id = 1:66, h = 1)
tempPre = tempTimeSlice %>% inner_join(tempDate) %>% inner_join(tempDistrict) %>%
select(-h)
tempPre = tempPre[!(tempPre$day %in% c(24, 28) &
tempPre$timeSlice == 46), ]
tempPre$F1 = tempPre$timeSlice - 1
tempPre$F2 = tempPre$timeSlice - 2
tempPre$F3 = tempPre$timeSlice - 3
temp=testing
names(temp)[3]="rF1"
names(temp)[4]="aF1"
temp1=tempPre %>% left_join(temp, by = c("F1" = "timeSlice", "day", "district_id"))
names(temp)[3]="rF2"
names(temp)[4]="aF2"
temp2=temp1 %>% left_join(temp, by = c("F2" = "timeSlice", "day", "district_id"))
names(temp)[3]="rF3"
names(temp)[4]="aF3"
temp3=temp2 %>% left_join(temp, by = c("F3" = "timeSlice", "day", "district_id"))
myPre=temp3
myPre=myPre%>%select(-(F1:F3))
myPre=myPre %>% left_join(myDateFeature,by="day")
myPre$"weekday"=as.character(myPre$"weekday")
myPre$"district_id"=as.character(myPre$"district_id")
myPre$"timeSlice"=as.character(myPre$"timeSlice")
# training set
tempTimeSlice = data_frame(timeSlice = seq(from = 46, to = 142, by = 12), h = 1)
tempDate = data_frame(day = seq(from = 1, to = 21, by = 1), h = 1)
tempDistrict = data_frame(district_id = 1:66, h = 1)
tempTrain = tempTimeSlice %>% inner_join(tempDate) %>% inner_join(tempDistrict) %>%select(-h)
tempTrain$F1 = tempTrain$timeSlice - 1
tempTrain$F2 = tempTrain$timeSlice - 2
tempTrain$F3 = tempTrain$timeSlice - 3
temp=training
temp1=tempTrain %>% left_join(temp, by = c("timeSlice" = "timeSlice", "day", "district_id"))
names(temp)[3]="rF1"
names(temp)[4]="aF1"
temp2=temp1 %>% left_join(temp, by = c("F1" = "timeSlice", "day", "district_id"))
names(temp)[3]="rF2"
names(temp)[4]="aF2"
temp3=temp2 %>% left_join(temp, by = c("F2" = "timeSlice", "day", "district_id"))
names(temp)[3]="rF3"
names(temp)[4]="aF3"
temp4=temp3 %>% left_join(temp, by = c("F3" = "timeSlice", "day", "district_id"))
myTrain=temp4
myTrain=myTrain%>%mutate(gap=r-a)
myTrain=myTrain%>%select(-(F1:F3))
myTrain=myTrain %>% left_join(myDateFeature,"day")
myTrain$"weekday"=as.character(myTrain$"weekday")
myTrain$"district_id"=as.character(myTrain$"district_id")
myTrain$"timeSlice"=as.character(myTrain$"timeSlice")
# simple lm
myLmFit=lm(gap~(rF1+aF1+rF2+aF2+rF3+aF3)*district_id,myTrain)
myPre$pre=predict(myLmFit,myPre)
myPre$pre=pmax(myPre$pre,0)
myPre$pre=floor(myPre$pre)
myOut=data_frame(district_id=myPre$district_id,timeSlice=paste0("2016-01-",value=myPre$day,"-",myPre$timeSlice),myPre$pre)
library(pryr)
?new.env
?new.packages
library(pryr)
e=new.env()
e$a=1
e$b=e$a
e$a=b
d$a
e=new.env()
e$a=1
e$b=e$a
e$a=2
d$a
e=new.env()
e$a=1
e$b=e$a
e$a=2
e$a
a=1
b=a
a=2
a
e=new.env()
e$a=1
e$b=e$a
e$b=2
e$a
e=new.env()
e$a=1:3
e$b=e$a
e$b=2:5
e$a
library(pryr)
e<-new.env()
e$a<-1:3
e$b<-e$a
e$b<-2:5
e$a
e<-new.env()
e$a<-1:3
library(pryr)
e<-new.env()
e$a<-1:3
e$b<-e$a
e$b<-2:5
e$a
e$b
environment()
library(ggplot2)
environment()
search()
?attach
?as.environment
function(){
environment()
}()
function(){
search()
}()
function(){
search()
}
a=function(){
search()
}
a()
ls()
ls(e)
as.environment(e)
search()
?search
environment()
e
as.envoronment("stats")
as.environment("stats")
?ls
ls.str(as.environment("package:ggplot2"))
where
stopifnot
?stopifnot
environment(a)
e=function(){
search()
}
environment(a)
e=function(){
search()
f=function(){
a=1
}
environment(f)
}
a()
e=function(){
f=function(){
a=1
}
environment(f)
}
a()
e=function(){
f=function(){
a=1
}
environment(f)
}
e()
environment(lm)
myLm=lm
environment(myLm)
g <- function(x) {
if (!exists("a", inherits = FALSE)) {
message("Defining a")
a <- 1
} else {
a <- a + 1
}
a
}
g(10)
g(10)
jj=2
h <- function(x) {
a <- jj
x + a
}
h(1)
jj=3
h(1)
?parent.frame
?traceback
-1:2
10:1
f <- function(a) g(a)
g <- function(b) h(b)
h <- function(c) i(c)
i <- function(d) "a" + d
f(10)
traceback
traceback()
f(10)
f(10)
traceback()
f(10)
ls()
d
?options
?debugger
library(xtable)
vignette(package="xtable")
vignette("xtableGallery")
setwd("~/Opt")
---
knit_with_parameters('~/Opt/median.Rmd')
